\NeedsTeXFormat{LaTeX2e}[2024-11-01]
\ProvidesPackage{zhw-math}[2025-10-29 v0.1 A package that correctly configures custom theorems with hyperref, as well as a few mathematics macros. For my own personal use.]

\RequirePackage{amsmath}
\RequirePackage{amssymb}
\RequirePackage{unicode-math}

%%% THE ORDER MATTERS HERE %%%
\RequirePackage{hyperref}
\RequirePackage{amsthm}
\RequirePackage{thmtools}
\RequirePackage{cleveref}

\PassOptionsToPackage{hypertexnames = false}{hyperref}
\PassOptionsToPackage{noabbrev, capitalise, nameinlink}{cleveref}

%%% MATHEMATICS MACROS %%%
%% PERMUTATION CYCLE NOTATION %%
\ExplSyntaxOn
\NewDocumentCommand{\cycle}{ O{\;} m }
 {
  (
  \alec_cycle:nn { #1 } { #2 }
  )
 }

\seq_new:N \l_alec_cycle_seq
\cs_new_protected:Npn \alec_cycle:nn #1 #2
 {
  \seq_set_split:Nnn \l_alec_cycle_seq { , } { #2 }
  \seq_use:Nn \l_alec_cycle_seq { #1 }
 }
\ExplSyntaxOff

%% BRAKETS %%
\newcommand{\bra}[1]{\left\langle\mathinner{#1}\right\rvert}
\newcommand{\ket}[1]{\left\lvert\mathinner{#1}\right\rangle}
\newcommand{\braket}[2]{\left\langle\mathinner{#1}\middle\vert\mathinner{#2}\right\rangle}

\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator{\Sym}{Sym}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\image}{im}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\divg}{div}
\DeclareMathOperator{\grad}{grad}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\variance}{var}
\DeclareMathOperator{\graph}{Gr}
\DeclareMathOperator{\lin}{lin}%linear span/linear hull
\DeclareMathOperator{\conv}{conv}%convex hull
\DeclareMathOperator{\coker}{coker}

\newcommand{\E}{\mathbf{E}}%expected value

%%%%%%%% OTHER MACROS %%%%%%
\newcommand{\ac}[1]{\textls{\textsc{#1}}}

%making sure referencing for equations doesn't include parentheses
\creflabelformat{equation}{#2\textup{#1}#3}

%proof styling
\renewenvironment{proof}[1][\MakeLowercase{\proofname}]{\par
\pushQED{\qed}%
\normalfont \topsep6\p@\@plus6\p@\relax
\trivlist
\item\relax
{\scshape
#1\@addpunct{.}}\hspace\labelsep\ignorespaces
}{%
\popQED\endtrivlist\@endpefalse
}
\renewcommand\qedsymbol{$\blacksquare$}

%theorem styling
\newtheoremstyle{proposition}%
{2ex}%
{2ex}%
{}%body font
{}%indent amount for whole theorem
{\scshape}%head font
{.}%punctuation after head
{1em}%space after theorem head
{}%head spec

%comment styling
\newtheoremstyle{comment}%
{2ex}%
{2ex}%
{}%body font
{}%same as above but no indent.
{\scshape}%head font
{.}%punctuation after head
{ }%space after theorem head
{}%head spec

%using thmtools's \declaretheorem to declare theorems
\declaretheorem[style=proposition, name=proposition, numberwithin=section, refname={Proposition, Propositions}]{prop}
\declaretheorem[style=proposition, name=proposition, numbered=no]{prop*}

\declaretheorem[style=proposition, sibling=prop, name=theorem, refname={Theorem, Theorems}]{thm}
\declaretheorem[style=proposition, name=theorem, numbered=no]{thm*}

\declaretheorem[style=proposition, sibling=prop, name=lemma, refname={Lemma, Lemmata}]{lem}
\declaretheorem[style=proposition, name=lemma, numbered=no]{lem*}

\declaretheorem[style=proposition, name=corollary, numberwithin=prop, refname={Corollary, Corollaries}]{corl}
\declaretheorem[style=proposition, name=corollary, numbered=no]{corl*}

\declaretheorem[style=proposition, name=definition, numberwithin=section, refname={Definition, Definitions}]{defn}
\declaretheorem[style=proposition, name=definition, numbered=no]{defn*}

\declaretheorem[style=proposition, name=axiom, refname={Axiom, Axioms}]{ax}

\declaretheorem[style=comment, name=remark, numbered=no]{rmk}
\declaretheorem[style=comment, name=example, numbered=no]{exm}
\declaretheorem[style=comment, name=exercise, numberwithin=section, refname={Exercise, Exercises}]{exc}
\declaretheorem[style=comment, name=exercise, numbered=no]{exc*}
